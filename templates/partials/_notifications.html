<div class="p-4 border-b border-slate-200 dark:border-slate-700">
    <h3 class="font-semibold text-slate-900 dark:text-white">Notifications</h3>
</div>

<div class="divide-y divide-slate-200 dark:divide-slate-700">
    {% for notification in notifications %}
        <div id="notif-{{ notification.id }}"
        {% comment %}  {% endcomment %}
             hx-post="{% url 'mark_notification_read' notification.id %}"
             hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
             hx-target="#notif-{{ notification.id }}"
             hx-swap="outerHTML">

            {% if notification.notification_type == "ticket_ready" %}
                <a href="{% url 'event_detail' notification.registration.event.slug %}"
                   class="flex items-center gap-4 p-4 hover:bg-slate-50 dark:hover:bg-slate-700">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center">
                        <svg {% if not notification.is_read %}class="w-6 h-6 text-blue-600 dark:text-blue-400"{% else %}class="w-6 h-6 text-slate-600 dark:text-slate-400"{% endif %}
                             xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                             stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-12v.75m0 3v.75m0 3v.75m0 3V18m-3 .75h18A2.25 2.25 0 0021 16.5V7.5A2.25 2.25 0 0018.75 5.25H5.25A2.25 2.25 0 003 7.5v9A2.25 2.25 0 005.25 18.75z" />
                        </svg>
                    </div>
                    <div class="flex-grow">
                        <p class="text-sm text-slate-800 dark:text-slate-200">
                            Your ticket for <strong>{{ notification.registration.event.title }}</strong> is ready!
                        </p>
                        <p class="text-xs text-slate-500">{{ notification.created_at|timesince }} ago</p>
                    </div>
                    {% if not notification.is_read %}
                        <div class="flex-shrink-0 w-2.5 h-2.5 rounded-full bg-blue-500"></div>
                    {% endif %}
                </a>
            {% endif %}

            {% if notification.notification_type == "event_reminder" %}
                <a href="{% url 'event_detail' notification.registration.event.slug %}"
                   class="flex items-center gap-4 p-4 hover:bg-slate-50 dark:hover:bg-slate-700">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center">
                        <svg {% if not notification.is_read %}class="w-6 h-6 text-blue-600 dark:text-blue-400"{% else %}class="w-6 h-6 text-slate-600 dark:text-slate-400"{% endif %}
                             xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                             stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M-4.5 12h22.5" />
                        </svg>
                    </div>
                    <div class="flex-grow">
                        <p class="text-sm text-slate-600 dark:text-slate-300">
                            <strong>{{ notification.registration.event.title }}</strong>
                            is starting in {{ notification.message }} days.
                        </p>
                        <p class="text-xs text-slate-500">{{ notification.created_at|timesince }} ago</p>
                    </div>
                    {% if not notification.is_read %}
                        <div class="flex-shrink-0 w-2.5 h-2.5 rounded-full bg-blue-500"></div>
                    {% endif %}
                </a>
            {% endif %}
        </div>
    {% empty %}
        <p class="p-4 text-sm text-slate-500 dark:text-slate-400">No notifications</p>
    {% endfor %}
</div>

<div class="p-2 border-t border-slate-200 dark:border-slate-700">
    <a href="{% url 'notifications_list' %}"
       class="block w-full text-center text-sm font-semibold text-blue-600 dark:text-blue-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-md py-2">
        View all notifications
    </a>
</div>


{% comment %} Unread notifications count badge {% endcomment %}
<span id="notif-badge"
      hx-swap-oob="true"
      class="absolute -top-0.5 -right-0.5 flex h-3 w-3">
    {% if unread.count > 0 %}
        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
        <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
    {% endif %}
</span>
